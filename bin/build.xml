<?xml version="1.0" encoding="UTF-8"?>

<!--
*******************************************************************************

  Ant script for the Clematis project.

  General targets:
  clean         - cleans all build products.
  compile       - compiles Java sources.
  pack          - creates the application archives.
  doc           - builds the project documentation.
  rebuild-all   - cleans all build products and re-builds the project.

  Author: Anton Troshin (tysinsh@comail.ru)

*******************************************************************************
-->

<project name="Clematis" default="build" basedir=".">
    <!--
    ***************************************************************************
    Initialization
    ***************************************************************************
    -->
    <target name="init">
        <property file="build.properties"/>
        <path id="project.class.path">
            <fileset dir="${lib.dir}" includes="_*.jar"/>
            <fileset dir="${lib.dir}" includes="*.jar"/>
        </path>
    </target>
    <!--
    ***************************************************************************
    Cleans all build products.
    ***************************************************************************
    -->
    <target name="clean" depends="init"
        description="Cleans all build products.">
        <delete dir="${build.classes.dir}"/>
        <delete dir="${build.doc.api.dir}"/>
    </target>
    <!--
    ***************************************************************************
    Compiles Java sources.
    ***************************************************************************
    -->
    <target name="compile" depends="init" description="Compiles Java sources.">
        <mkdir dir="${build.classes.dir}"/>
        <javac srcdir="${src.dir}" destdir="${build.classes.dir}"
            classpathref="project.class.path"
            compiler="${compile.compiler}"
            fork="${compile.fork}"
            debug="${compile.debug}"
            optimize="${compile.optimize}"
            deprecation="on"
            target="${compile.target}">
        </javac>
    </target>
    <!--
    ***************************************************************************
    Creates the application archive.
    ***************************************************************************
    -->
    <target name="pack" depends="compile" description="Creates the application archive.">

        <mkdir dir="${build.archives.dir}"/>

    <!-- jw.jar -->
        <jar jarfile="${build.archives.dir}/jw.jar">
            <fileset dir="${build.classes.dir}">
                <include name="**/jworkspace/**"/>
            </fileset>
            <zipfileset dir="${src.dir}/jworkspace/logo"
                includes="*.*"
                prefix="jworkspace/logo"
            />
            <zipfileset dir="${src.dir}/jworkspace/images"
                includes="*.*"
                prefix="jworkspace/images"
            />
            <zipfileset dir="${src.dir}/jworkspace/images/installer"
                includes="*.*"
                prefix="jworkspace/images/installer"
            />
            <zipfileset dir="${src.dir}/jworkspace/images/filedlg"
                includes="*.*"
                prefix="jworkspace/images/filedlg"
            />
            <zipfileset dir="${src.dir}/jworkspace/images/desktop"
                includes="*.*"
                prefix="jworkspace/images/desktop"
            />
            <zipfileset dir="${src.dir}/jworkspace/images/cpanel/hover"
                includes="*.*"
                prefix="jworkspace/images/cpanel/hover"
            />
            <zipfileset dir="${src.dir}/jworkspace/images/cpanel/normal"
                includes="*.*"
                prefix="jworkspace/images/cpanel/normal"
            />
            <zipfileset dir="${src.dir}/jworkspace/html/docs"
                includes="*.*"
                prefix="jworkspace/html/docs"
            />
        </jar>

    </target>
    <!--
    ***************************************************************************
    Builds the project documentation.
    ***************************************************************************
    -->
    <target name="doc" depends="init" description="Builds the project documentation.">

        <mkdir dir="${build.doc.api.dir}"/>
        <javadoc destdir="${build.doc.api.dir}"
            access="${javadoc.access}"
            author="true"
            version="true"
            use="true"
            windowtitle="Java Workspace API"
            classpathref="project.class.path">
            <packageset dir="${src.dir}" defaultexcludes="yes">
                <include name="jworkspace/**"/>
            </packageset>
            <link href="http://java.sun.com/j2se/1.4.2/docs/api/"/>
        </javadoc>
    </target>
    <!--
    ***************************************************************************
    Builds the project.
    ***************************************************************************
    -->
    <target name="build" depends="compile, pack"
        description="Cleans all build products and re-builds the project.">
    </target>
    <!--
    ***************************************************************************
    Cleans all build products and re-builds the project.
    ***************************************************************************
    -->
    <target name="rebuild-all" depends="clean, pack, doc"
        description="Cleans all build products and re-builds the project.">
    </target>

</project>